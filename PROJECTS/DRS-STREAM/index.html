<!doctype html>
<html lang="en" class="h-full">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DRS Stream — Project Info</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;800&family=JetBrains+Mono:wght@400;600&display=swap"
    rel="stylesheet" />
  <script>
    tailwind = {
      config: {
        theme: {
          extend: {
            fontFamily: { display: ['Orbitron', 'ui-sans-serif', 'system-ui'], mono: ['JetBrains Mono', 'ui-monospace', 'SFMono-Regular'] },
            colors: { neon: '#22d3ee', magenta: '#e879f9', acid: '#a3e635', deep: '#0b1020' },
            boxShadow: { glow: '0 0 10px rgba(34,211,238,0.25), 0 0 22px rgba(232,121,249,0.2)' }
          }
        }
      }
    }
  </script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body::before {
      content: "";
      position: fixed;
      inset: 0;
      pointer-events: none;
      background:
        radial-gradient(1200px 600px at 10% 0%, rgba(34, 211, 238, 0.08), transparent 60%),
        radial-gradient(800px 400px at 90% 10%, rgba(232, 121, 249, 0.08), transparent 60%),
        radial-gradient(1000px 500px at 50% 90%, rgba(163, 230, 53, 0.06), transparent 60%);
      filter: blur(0.5px);
    }

    .grid-bg {
      background-image: linear-gradient(rgba(255, 255, 255, 0.04) 1px, transparent 1px), linear-gradient(90deg, rgba(255, 255, 255, 0.04) 1px, transparent 1px);
      background-size: 60px 60px, 60px 60px;
      background-position: -1px -1px, -1px -1px
    }

    .code {
      font-family: 'JetBrains Mono', ui-monospace, monospace
    }
  </style>

</head>

<body class="min-h-screen bg-[#0b1020] grid-bg text-zinc-100 selection:bg-neon/30 selection:text-white">
  <main class="mx-auto max-w-4xl px-6 py-10">
    <header class="mb-8">
      <h1 class="font-display text-4xl md:text-5xl font-extrabold tracking-[0.25em]">
        <span class="text-neon drop-shadow-[0_0_10px_rgba(34,211,238,.55)]">DRS</span>
        <span class="text-magenta"> STREAM</span>
        <span class="text-acid"> PROJECT INFO</span>
      </h1>
      <p class="text-zinc-400 mt-2">Remote streaming over Tailscale · MediaMTX · Docker</p>
      <div class="mt-4 flex gap-3 items-center">
        <a href="https://github.com/driesjuhhhh/drs-stream" target="_blank" rel="noopener noreferrer"
          class="inline-flex items-center rounded-lg border border-neon/60 bg-neon/10 px-3 py-2 text-xs text-neon hover:bg-neon/20 hover:border-neon/80">Open
          GitHub Repo</a>
      </div>
    </header>

    <section class="rounded-2xl border border-zinc-800/80 bg-zinc-900/40 backdrop-blur-md p-6 md:p-7 shadow-glow">
      <h2 class="text-xl font-semibold mb-2">Overview</h2>
      <p class="text-zinc-300">This project enables remote live streaming from a Raspberry Pi client to a homelab server
        using Docker, Tailscale, MediaMTX (RTMP/HLS), and a web dashboard to control devices and monitor bitrate.</p>
      <p class="text-zinc-400 mt-3 text-sm">Gear I use: DJI Osmo Action 4 (as camera), Linux Mint Homelab server, Raspberry Pi 5</p>
      <div class="mt-4 grid grid-cols-1 md:grid-cols-3 gap-4">
        <div class="rounded-xl border border-zinc-800/70 p-4 bg-zinc-900/40">
          <div class="text-xs text-zinc-400 uppercase tracking-wider">Homelab Server</div>
          <div class="mt-2 font-mono text-neon">Linux Mint</div>
        </div>
        <div class="rounded-xl border border-zinc-800/70 p-4 bg-zinc-900/40">
          <div class="text-xs text-zinc-400 uppercase tracking-wider">Client</div>
          <div class="mt-2 font-mono text-magenta">Raspberry Pi 5</div>
        </div>
        <div class="rounded-xl border border-zinc-800/70 p-4 bg-zinc-900/40">
          <div class="text-xs text-zinc-400 uppercase tracking-wider">Camera</div>
          <div class="mt-2 font-mono text-acid">USB Camera </div>
        </div>
      </div>
    </section>

    <section class="mt-6 rounded-2xl border border-zinc-800/80 bg-zinc-900/40 backdrop-blur-md p-6 md:p-7 shadow-glow">
      <h2 class="text-xl font-semibold mb-2">Complete Setup Guide</h2>
      <ol class="list-decimal list-inside text-zinc-300 space-y-3">
        <li>
          Prerequisite: ensure the Raspberry Pi has a reliable uplink via mobile data or a 4G/LTE router. Wi‑Fi
          tethering/hotspot also works.
        </li>
        <li>
          Install Docker on both machines (Linux Mint server and Raspberry Pi).
          See the “Install Docker” section below for Mint; for Pi use Raspberry Pi OS/Debian instructions.
        </li>
        <li>
          Install Tailscale on both, authenticate, and ensure both devices appear online.
          Make sure your OBS streaming PC is also connected to the same tailnet.
        </li>
        <li>
          Clone the repository on both machines:
          <pre class="code bg-zinc-900/60 border border-zinc-700/70 rounded p-3 overflow-auto text-sm">git clone https://github.com/driesjuhhhh/drs-stream.git
cd drs-stream</pre>
        </li>
        <li>
          Create and fill <span class="code">.env</span> files with required variables:
          <div class="mt-2 grid grid-cols-1 md:grid-cols-2 gap-3">
            <div>
              <div class="text-xs text-zinc-400 uppercase tracking-wider">homelab/.env</div>
              <pre class="code bg-zinc-900/60 border border-zinc-700/70 rounded p-3 overflow-auto text-sm">SERVER_TAILSCALE_IP=&lt;server tailscale ip&gt;
CLIENT_TAILSCALE_IP=&lt;pi tailscale ip&gt;
CLIENT_API_PORT=8088
MTX_API_URL=http://mediamtx:9997
MTX_STREAM_PATH=stream</pre>
            </div>
            <div>
              <div class="text-xs text-zinc-400 uppercase tracking-wider">pi/control/.env</div>
              <pre class="code bg-zinc-900/60 border border-zinc-700/70 rounded p-3 overflow-auto text-sm">RTMP_URL=rtmp://&lt;server tailscale ip&gt;:1935/stream
VIDEO_DEVICE=/dev/video0
AUDIO_DEVICE=default  # or hw:1,0
WIDTH=1920
HEIGHT=1080
FPS=30</pre>
            </div>
          </div>
        </li>
        <li>
          Start services on both machines:
          <div class="mt-2 grid grid-cols-1 md:grid-cols-2 gap-3">
            <div>
              <div class="text-xs text-zinc-400 uppercase tracking-wider">On the server (homelab/)</div>
              <pre class="code bg-zinc-900/60 border border-zinc-700/70 rounded p-3 overflow-auto text-sm">cd homelab
docker compose up -d --build</pre>
            </div>
            <div>
              <div class="text-xs text-zinc-400 uppercase tracking-wider">On the Pi (pi/)</div>
              <pre class="code bg-zinc-900/60 border border-zinc-700/70 rounded p-3 overflow-auto text-sm">cd pi
docker compose up -d --build</pre>
            </div>
          </div>
        </li>
        <li>
          Open the dashboard on the server and find the URLs for OBS:
          <pre
            class="code bg-zinc-900/60 border border-zinc-700/70 rounded p-3 overflow-auto text-sm">http://&lt;server tailscale ip&gt;:8069/</pre>
          Use the dashboard to view status and copy ingest/playback URLs (RTMP/HLS) for OBS.
        </li>
      </ol>
    </section>

    <section class="mt-6 rounded-2xl border border-zinc-800/80 bg-zinc-900/40 backdrop-blur-md p-6 md:p-7 shadow-glow">
      <h2 class="text-xl font-semibold mb-2">Install Docker</h2>
      <div class="text-zinc-300">
        <p>On Linux Mint (Ubuntu/Debian-based):</p>
        <pre class="code bg-zinc-900/60 border border-zinc-700/70 rounded p-3 overflow-auto text-sm">sudo apt update
sudo apt install -y ca-certificates curl gnupg
sudo install -m 0755 -d /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
sudo chmod a+r /etc/apt/keyrings/docker.gpg
echo "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu $(. /etc/os-release && echo $VERSION_CODENAME) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
sudo apt update
sudo apt install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
sudo usermod -aG docker $USER
# log out/in to apply group</pre>
      </div>
    </section>

    <section class="mt-6 rounded-2xl border border-zinc-800/80 bg-zinc-900/40 backdrop-blur-md p-6 md:p-7 shadow-glow">
      <h2 class="text-xl font-semibold mb-2">Install Tailscale</h2>
      <div class="text-zinc-300">
        <p>Server and Pi:</p>
        <pre class="code bg-zinc-900/60 border border-zinc-700/70 rounded p-3 overflow-auto text-sm">curl -fsSL https://tailscale.com/install.sh | sh
sudo tailscale up  # authenticate via browser</pre>
        <p class="mt-2">Note the Tailscale IPs for the server and Pi.</p>
      </div>
    </section>

    <section class="mt-6 rounded-2xl border border-zinc-800/80 bg-zinc-900/40 backdrop-blur-md p-6 md:p-7 shadow-glow">
      <h2 class="text-xl font-semibold mb-2">Project Structure</h2>
      <pre class="code bg-zinc-900/60 border border-zinc-700/70 rounded p-3 overflow-auto text-sm">homelab/
  ui/                # Dashboard & overlay server
    app.js           # Express server
    index.html       # Dashboard UI
    Dockerfile       # UI container
    docker-compose.yml
    .env             # Server IPs, MediaMTX config
  README.md
pi/
  control/           # Pi control API (Python)
    app.py
    Dockerfile
    requirements.txt
    .env
  docker-compose.yml
  README.md</pre>
    </section>

    <section class="mt-6 rounded-2xl border border-zinc-800/80 bg-zinc-900/40 backdrop-blur-md p-6 md:p-7 shadow-glow">
      <h2 class="text-xl font-semibold mb-2">Configure Environment</h2>
      <p class="text-zinc-300">Set the following variables in each <span class="code">.env</span>:</p>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-3">
        <div class="rounded-xl border border-zinc-800/70 p-4 bg-zinc-900/40">
          <div class="text-xs text-zinc-400 uppercase tracking-wider">homelab/.env</div>
          <pre class="code bg-zinc-900/60 border border-zinc-700/70 rounded p-3 overflow-auto text-sm">SERVER_TAILSCALE_IP=&lt;server tailscale ip&gt;
CLIENT_TAILSCALE_IP=&lt;pi tailscale ip&gt;
CLIENT_API_PORT=8088
MTX_API_URL=http://mediamtx:9997
MTX_API_KEY=&lt;optional bearer token&gt;
MTX_STREAM_PATH=stream</pre>
        </div>
        <div class="rounded-xl border border-zinc-800/70 p-4 bg-zinc-900/40">
          <div class="text-xs text-zinc-400 uppercase tracking-wider">pi/control/.env</div>
          <pre class="code bg-zinc-900/60 border border-zinc-700/70 rounded p-3 overflow-auto text-sm">RTMP_URL=rtmp://&lt;server tailscale ip&gt;:1935/stream
VIDEO_DEVICE=/dev/video0
AUDIO_DEVICE=default  # or hw:1,0
BITRATE_KBPS=6000</pre>
        </div>
      </div>
    </section>

    <section class="mt-6 rounded-2xl border border-zinc-800/80 bg-zinc-900/40 backdrop-blur-md p-6 md:p-7 shadow-glow">
      <h2 class="text-xl font-semibold mb-2">Docker Compose — Homelab</h2>
      <p class="text-zinc-300">From <span class="code">homelab/</span>:</p>
      <pre class="code bg-zinc-900/60 border border-zinc-700/70 rounded p-3 overflow-auto text-sm"># Build & start UI + MediaMTX (if included)
docker compose up -d --build
# View logs
docker compose logs -f
# Stop
docker compose down</pre>
    </section>

    <section class="mt-6 rounded-2xl border border-zinc-800/80 bg-zinc-900/40 backdrop-blur-md p-6 md:p-7 shadow-glow">
      <h2 class="text-xl font-semibold mb-2">Docker Compose — Raspberry Pi</h2>
      <p class="text-zinc-300">On the Pi, from <span class="code">pi/</span>:</p>
      <pre class="code bg-zinc-900/60 border border-zinc-700/70 rounded p-3 overflow-auto text-sm"># Build & start the control container
docker compose up -d --build
# View logs
docker compose logs -f
# Stop
docker compose down</pre>
    </section>

    <footer class="mt-8 text-xs text-zinc-500">© DRS Stream — Project Info</footer>
  </main>
  <script>
    // Files to include in the zip (exclude any .env files)
    const FILES = [
      // project root
      'info.md',
      '.gitattributes',
      '.gitignore',
      // projectinfo
      'projectinfo/index.html',
      // homelab
      'homelab/README.md',
      'homelab/docker-compose.yml',
      'homelab/ui/app.js',
      'homelab/ui/index.html',
      'homelab/ui/Dockerfile',
      'homelab/ui/package.json',
      'homelab/ui/docker-compose.yml',
      // pi
      'pi/README.md',
      'pi/docker-compose.yml',
      'pi/control/app.py',
      'pi/control/Dockerfile',
      'pi/control/requirements.txt',
    ];



    // Add copy-to-clipboard buttons to all code blocks
    function copyTextFallback(text) {
      const ta = document.createElement('textarea');
      ta.value = text;
      ta.setAttribute('readonly', '');
      ta.style.position = 'fixed';
      ta.style.top = '-1000px';
      document.body.appendChild(ta);
      ta.select();
      try { document.execCommand('copy'); } catch (_) { }
      document.body.removeChild(ta);
    }

    async function copyText(text) {
      // Try Clipboard API first, regardless of secure context
      try {
        if (navigator.clipboard && navigator.clipboard.writeText) {
          await navigator.clipboard.writeText(text);
          return true;
        }
      } catch (_) { }
      // Fallback: hidden textarea
      try {
        copyTextFallback(text);
        return true;
      } catch (_) { }
      // Fallback: select the pre content and execCommand('copy')
      try {
        const sel = window.getSelection();
        const range = document.createRange();
        const temp = document.createElement('pre');
        temp.style.position = 'fixed';
        temp.style.top = '-1000px';
        temp.textContent = text;
        document.body.appendChild(temp);
        range.selectNodeContents(temp);
        sel.removeAllRanges();
        sel.addRange(range);
        document.execCommand('copy');
        sel.removeAllRanges();
        document.body.removeChild(temp);
        return true;
      } catch (_) { }
      return false;
    }

    function enhanceCodeBlocks() {
      const pres = document.querySelectorAll('pre.code');
      pres.forEach((pre) => {
        // Wrap pre in a relative container
        const wrapper = document.createElement('div');
        wrapper.className = 'relative';
        wrapper.style.position = 'relative';
        wrapper.style.marginTop = '0.25rem';
        pre.parentNode.insertBefore(wrapper, pre);
        wrapper.appendChild(pre);

        const btn = document.createElement('button');
        btn.type = 'button';
        btn.setAttribute('aria-label', 'Copy code');
        btn.className = 'absolute top-2 right-2 z-10 inline-flex items-center rounded-md border border-zinc-700/70 bg-zinc-800/70 px-2 py-1 text-xs text-zinc-300 hover:border-neon/60 hover:text-neon hover:bg-neon/10';
        btn.textContent = 'Copy';
        btn.addEventListener('click', async (ev) => {
          ev.stopPropagation();
          const text = pre.innerText || pre.textContent || '';
          const ok = await copyText(text);
          const prev = btn.textContent;
          btn.textContent = ok ? 'Copied!' : 'Error';
          btn.classList.toggle('text-acid', ok);
          setTimeout(() => { btn.textContent = prev; btn.classList.remove('text-acid'); }, 1200);
        });
        wrapper.appendChild(btn);
      });
    }

    document.addEventListener('DOMContentLoaded', enhanceCodeBlocks);
  </script>
</body>

</html>